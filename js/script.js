function initMap(){var e=[{featureType:"all",stylers:[{hue:"#02b3e4"},{saturation:-80}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{hue:"#00ffee"},{saturation:50}]},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]}];map=new google.maps.Map(document.getElementById("map"),{center:{lat:24.774265,lng:46.738586},zoom:11,styles:e,mapTypeControl:!1})}function markerWindow(e,t){if(t.marker!=e){t.marker=e;var i="https://en.wikipedia.org/w/api.php?action=opensearch&search="+e.title+"&format=json&callback=wikiCallback",a=setTimeout(function(){t.setContent('<p class="info-text">failed to get wikipedia resources</p>')},8e3);t.setContent(""),$.ajax({url:i,dataType:"jsonp"}).done(function(i){for(var o=i[1],n=0;n<o.length;n++){var s=o[n],l="https://www.wikipedia.org/wiki/"+s;t.setContent('<div class="info-text "><h4>'+e.title+'</h4><p class="info-text">Website: <a href="'+e.website+'" target="_blank"> Click here </a></p></div></h4><p class="info-text">Wiki Info: <a href="'+l+'" target="_blank"> Click here </a></p></div>')}clearTimeout(a)}),t.open(map,e),t.addListener("closeclick",function(){t.close(),e.setAnimation(null)})}}function mapError(){console.log("Error: Google maps API has not loaded"),alert("There was an error occured with the Google Maps. Please try again later.")}var map,locations=[{title:"King Saud University",location:{lat:24.716241,lng:46.619108},website:"http://ksu.edu.sa/en"},{title:"Imam Muhammad ibn Saud Islamic University",location:{lat:24.813595,lng:46.701929},website:"https://imamu.edu.sa/en"},{title:"Princess Nora bint Abdul Rahman University",location:{lat:24.846461,lng:46.724731},website:"http://pnu.edu.sa/en"},{title:"Riyadh College of Technology",location:{lat:24.733313,lng:46.704871},website:"http://www.rct.edu.sa/"},{title:"Alfaisal University",location:{lat:24.664302,lng:46.675966},website:"http://www.alfaisal.edu/"},{title:"King Saud bin Abdulaziz University for Health Sciences",location:{lat:24.754502,lng:46.853317},website:"http://conj.ksau-hs.edu.sa"},{title:"Prince Sultan University",location:{lat:24.734742,lng:46.697575},website:"http://www.psu.edu.sa/en"},{title:"Dar Al Uloom University",location:{lat:24.795804,lng:46.711291},website:"http://dau.edu.sa/en/"},{title:"Al Yamamah University",location:{lat:24.862597,lng:46.59184},website:"http://yu.edu.sa/"},{title:"Saudi Electronic University",location:{lat:24.793859,lng:46.676259},website:"https://www.seu.edu.sa/sites/en"}],Location=function(e){this.title=e.title,this.location=e.location,this.website=e.website},mapViewModel=function(){function e(e){if(null!==e.getAnimation())e.setAnimation(null);else{for(var i=0;i<t.locationList().length;i++){var a=t.locationList()[i].marker;null!==a.getAnimation()&&a.setAnimation(null)}e.setAnimation(google.maps.Animation.BOUNCE)}}var t=this;this.locationList=ko.observableArray([]),this.filter=ko.observable(),this.showClass=ko.observable("hamburger-menue"),locations.forEach(function(e){t.locationList.push(new Location(e))});var i=new google.maps.InfoWindow,a=new google.maps.LatLngBounds;t.locationList().forEach(function(t){var o=new google.maps.Marker({map:map,position:t.location,title:t.title,website:t.website,animation:google.maps.Animation.DROP});t.marker=o,o.setIcon("http://maps.google.com/mapfiles/ms/icons/red-dot.png"),t.marker.addListener("click",function(){markerWindow(this,i),e(this)}),a.extend(t.marker.position)}),google.maps.event.addDomListener(window,"resize",function(){map.fitBounds(a)}),this.filteredLocations=ko.computed(function(){var e=t.filter();return t.filter()?ko.utils.arrayFilter(t.locationList(),function(t){return-1!==t.title.toLowerCase().indexOf(e.toLowerCase())?t.marker.setMap(map):t.marker.setMap(null),-1!==t.title.toLowerCase().indexOf(e.toLowerCase())}):(t.locationList().forEach(function(e){e.marker.setMap(map)}),t.locationList())},t),this.currentLocation=ko.observable(this.locationList()[0]),this.setLocation=function(a){e(a.marker),markerWindow(a.marker,i),t.currentLocation(a)},toggleHamburger=function(){"hamburger-menue"==t.showClass()?t.showClass("hamburger-menue show"):t.showClass("hamburger-menue")}};window.onload=function(){var e=new mapViewModel;ko.applyBindings(e)};